create table airport  (airportid varchar(4) not null, name
varchar(100) not null, address varchar(250) not null, city
varchar(30) not null, country varchar(30), zipcode varchar(15)
 not null, primary key(airportid)) in dbadmin2;

create unique index idx_airport on airport(airportid);

create table airplane (airplaneid char(8) not null, type varchar(8)
not null, numseats int not null, totalfuel int not null,
primary key(airplaneid)) in dbadmin2;

create unique index idx_airplane on airplane(airplaneid);

create table flight (flightid int generated by default as
identity not null, flightdate date not null, deptime time 
not null, arrtime time not null, totpass int not null, 
totbagga int  not null, flightnum char(6)  not null, shiftid 
int not null, airplaneid char(8) not null, airportdep varchar(4) 
not null, airportarr varchar(4) not null, primary key(flightid), 
foreign key (airportdep) references airport(airportid) on delete 
restrict, foreign key (airportarr) references airport(airportid) 
on delete restrict, foreign key (airplaneid) references 
airplane(airplaneid) on delete restrict) in dbadmin2;

create unique index idx_flight on flight(flightid);

create table passengers (clientid int generated by default as 
identity not null, firstname varchar(30) not null, lastname 
varchar(30) not null, address varchar(250) not null, city 
varchar(50) not null, country varchar(30), zipcode varchar(15) 
not null, telephone varchar(18) not null, email varchar(100) 
not null, primary key(clientid)) in dbadmin2;

create unique index idx_pass on passengers(clientid);

create table ticket (ticketid char(10) not null, buyid int not 
null, clientid int not null, flightid int not null, seat char(3) 
not null, primary key (ticketid), foreign key (clientid) 
references passengers(clientid) on delete restrict, foreign key 
(flightid) references flight(flightid) on delete restrict) 
in dbadmin2;

create unique index idx_ticket on ticket(ticketid);

create table emplo (empid char(8) not null, firstname varchar(30)
not null, lastname varchar(30) not null, addre varchar(100) not 
null, city varchar(50) not null, zipcode varchar(15) not null, 
telephone varchar(10) not null, email varchar(100) not null, 
admidate date not null, salary dec(8,2) not null, deptid int not 
null, primary key(empid)) in dbadmin2; 

create unique index idx_emp on emplo(empid);

create table dept (deptid int not null, name varchar(20) not null, 
manager char(8), primary key (deptid), foreign key (manager) 
references emplo(empid) on delete restrict) in dbadmin2;

create unique index idx_dept on dept(deptid);

create table buy (buyid int generated by default as identity not 
null, buydate date not null, buytime time not null, price dec(7,2) 
not null, empid char(8) not null, clientid int not null, primary 
key(buyid), foreign key (empid) references emplo(empid) on delete 
restrict, foreign key(clientid) references passengers(clientid) on 
delete restrict) in dbadmin2;

create unique index idx_buy on buy(buyid);

create table crew (crewid int generated by default as identity not 
null, commander char(8) not null, copilote char(8) not null, fachief
char(8) not null, fliattendant1 char(8) not null, fliattendant2 
char(8) not null, fliattendant3 char(8) not null, primary 
key(crewid), foreign key (commander) references emplo(empid) on 
delete restrict, foreign key(copilote) references emplo(empid) 
on delete restrict, foreign key (fachief) references emplo(empid) 
on delete restrict, foreign key (fliattendant1) references 
emplo(empid) on delete restrict, foreign key (fliattendant2) 
references emplo(empid) on delete restrict, foreign key 
(fliattendant3) references emplo(empid) on delete restrict) in 
dbadmin2;

create unique index idx_crew on crew(crewid);

create table shift (shiftid int generated by default as identity 
not null, shiftdate date not null, begintime time not null, endtime 
time not null, crewid int not null, primary key (shiftid), foreign
key(crewid) references crew(crewid) on delete restrict) in dbadmin2;

create unique index idx_shift on shift(shiftid);	

alter table flight add foreign key (shiftid) references 
shift(shiftid) on delete restrict;

alter table emplo add foreign key (deptid) references 
dept(deptid) on delete restrict;

alter table ticket add foreign key (buyid) references buy(buyid) 
on delete restrict;
